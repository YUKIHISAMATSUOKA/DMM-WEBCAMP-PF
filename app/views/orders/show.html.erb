<div class="container-fluid">
  <div class="row">
    <div class="col-lg-6 offset-col-lg-6 mx-auto my-4">
      <h4 class="text-center"><%= @order.shop.name %></h4>

      <div class="order-show-title background">
        <h4>注文時間: <%= @order.created_at.strftime('%Y/%m/%d %H:%M') %></h4>
        <h4>受取時の名前: <%= @order.name %></h4>
        <h4>注文番号: <%= @order.number %></h4>
        <h4>注文状況: <%= @order.status %></h4>
        <h4>請求金額: <%= @order.billing_amount %>円</h4>
      </div>

      <% @order.order_items.each do |order_item| %>
        <div class="order-show-box background">
          <p class="order-show-box-text">
            商品名: <%= order_item.name %> <br>
            トッピング: テキストテキストテキストテキスト<br>
            <%= order_item.price %>円

          </p>
          <p class="order-show-picture"><%= attachment_image_tag order_item.item, :image, :fill, 150, 150, fallback: "no_image.jpg", size:'150x150', class: 'rounded-circle' %></p>
        </div>
      <% end %>

      <!--comments部分-->
      <div class="comments">
        <p>コメント件数：<%= @order.order_comments.count %></p>

        <% @order.order_comments.each do |order_comment| %>
          <div class="comment-box">
            <%= order_comment.created_at.strftime('%Y/%m/%d %H:%M') %>
            <!--もしオーダーのショップIdとカレントカスタマーのショップIdが一致していれば、ショップネームでコメントする-->
            <% if @order.shop.id == current_customer.shop.id %>
              ショップ名:<%= order_comment.customer.shop.name %>
            <% else %>
              <!--一致してなければ、注文したカスタマーになるので、注文時の名前でコメントする-->
              注文者:<%= @order.name %>
            <% end %>
            <div class="comment-text background">
              <%= order_comment.comment %>
              <% if order_comment.customer == current_customer %>
                <div class="comment-delete">
                  <%= link_to "コメントを削除", order_order_comment_path(order_comment.order, order_comment), method: :delete %>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>

      </div>

      <div class="new-comment">
        <%= form_with(model:[@order, @order_comment], local: true) do |f| %>
          <%= f.text_area :comment, rows:'5',placeholder: "コメントをここに" %>
          <%= f.submit "送信する" %>
        <% end %>
      </div>


    </div>
  </div>
</div>